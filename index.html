<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>Landing Point System</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://use.fontawesome.com/releases/v5.3.1/js/all.js" defer ></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css" />
  </head>
<body>

<script type="text/javascript">
// $(function() {
//   $('button#add').click(function(){
//   var tr_form = '' +
//     '<tr>'+
//     '<div class="field">' +
//     '<div class="control">' +
//     '<td><input class="input is-info" type="text" placeholder="PUBG Match ID" name="match_id[]"></td>' +
//     '</div>' +
//     '</div>' +
//     '</tr>';
//   var table = document.getElementById("table");
//   var row = table.insertRow(-1);
//   var cell = row.insertCell(-1);
//   cell.innerHTML =tr_form
//   });
// });

// $(function() {
//   $('button#delete').click(function(){
//     var table = document.getElementById("table");
//     table.deleteRow(-1)
//   });
// });

$(function() {
  $('button#send').click(function(){
    let element=document.getElementById('send');
    element.className='button is-warning is-loading'
    var match=document.getElementById('match').value;
    var region=document.getElementById('region').value;
    var myHeaders = new Headers();
    myHeaders.append("Content-Type", "application/json");
    var raw = JSON.stringify({"match":match,"region":region});
    var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
    };
    fetch("https://youeailb5j.execute-api.ap-northeast-1.amazonaws.com/default/make-landing-point-03", requestOptions)
    .then(response => response.text())
    .then(result => {
        window.location.href = JSON.parse(result).body;
        element.className='button is-primary is-warning'
        alert("Success!");
      })
    .catch(error => {
        console.log('error', error);
        element.className='button is-primary is-warning'
        alert("Error");
      });
  });
});

</script>

<section class="hero is-dark">
  <div class="hero-body">
    <div class="container">
      <h1 class="title">
        Landing Point System
      </h1>
      <h2 class="subtitle is-6">
        「航路」「各プレイヤーのパラシュート降下地点図」を作成
      </h2>
    </div>
  </div>
</section>

<section class="section">
<div class="container">
  <form>
    <!-- <button id="add" type="button" class="button is-primary">追加</button>
    <button id="delete" type="button" class="button is-danger">削除</button> -->
    <div class="control has-icons-left">
      <div class="select">
        <select id="region">
          <option selected value="as">Asia</option>
          <option value="tournament">Tournament</option>
        </select>
      </div>
        <span class="icon is-left">
          <i class="fas fa-globe"></i>
        </span>
    </div>
    <table class="table is-fullwidth" id="table">
      <tbody>
        <tr>
          <div class="field">
            <div class="control">
              <td><input class="input is-info" type="text" placeholder="PUBG Match ID" id="match"></td>
            </div>
          </div>
        </tr>
    </tbody>
  </table>
  <button id="send" type="button" class="button is-primary is-warning">送信</button>
  </form>
<div>
</section>

<footer class="footer">
  <div class="content has-text-centered">
    <p>
      <strong>Landing Point System</strong> by <a href="">TensionNote</a>.
    </p>
  </div>
</footer>

</body>
</html>